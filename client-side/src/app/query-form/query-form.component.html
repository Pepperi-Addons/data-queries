
<pep-page-layout [addPadding]="false" *ngIf="queryLoaded">
    <ng-container pep-top-area>
        <pep-top-bar [title]="mode == 'Add' ? ('Query_Add_Title' | translate) : ('Query_Edit_Title' | translate: {query_name: query.Name})">
            <div header-start-content>
                <!-- <pep-button class="pep-spacing-element" (buttonClick)="goBack()" [iconName]="'arrow_left_alt'"></pep-button> -->
            </div>
            <div header-end-content>
                <pep-button class="pep-spacing-element" [value]="'Back_to_list' | translate" (buttonClick)="goBack()"></pep-button> 
                <pep-button class="pep-spacing-element" [value]="'Save' | translate " [styleType]="'strong'" (buttonClick)="saveClicked()"></pep-button>
            </div>
        </pep-top-bar>
    </ng-container>

    <ng-container pep-main-area>
        <div class="flex">
            <pep-textbox
                [(value)]="query.Name"
                [label]="'Name' | translate"
                type="text"
                [mandatory]="true"
                [disabled]="false"
            ></pep-textbox>
            <pep-select
                [(value)]="query.Resource"
                [label]="'Resource' | translate"
                type="select"
                [mandatory]="true"
                [disabled]="query.Series.length>0"
                xAlignment="left"
                [options]="resourceOptions"
                [showTitle]="true"
                [emptyOption]="false"
                (valueChange)="resourceChanged($event)"
            ></pep-select>
        </div>
        <div class="genericListContainer">
            <pep-generic-list class="generic-list"
                [title] = "'Series' | translate"
                [showTopBar]="true"
                [dataSource]="seriesDataSource"
                [inline]="true"
                [actions]="seriesActions"
                [addPadding]="false"
                [showSearch]="false"
                [uuidMapping]="'Key'"
                [noDataFoundMsg] = "'SeriesNoDataFound' | translate"
                *ngIf="query.Resource"
                >
                <ng-container right-buttons>
                    <pep-button
                        class="pep-spacing-element"
                        [sizeType]="'sm'"
                        [value]="'Add' | translate"
                        [styleType]="'strong'" 
                        (buttonClick)="showSeriesEditorDialog(null)"
                    ></pep-button>
                </ng-container>
            </pep-generic-list>
        </div>
        <div class="genericListContainer">
            <pep-generic-list class="generic-list"
                [title] = "'Preview' | translate"
                [showTopBar]="true"
                [dataSource]="previewDataSource"
                [inline]="true"
                [addPadding]="false"
                [showSearch]="false"
                [uuidMapping]="'Key'"
                [selectionType] = "'none'"
                *ngIf="mode == 'Edit'"
                >
            </pep-generic-list>
        </div>
    </ng-container>
</pep-page-layout>

